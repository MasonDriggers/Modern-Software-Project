<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maya Angelou</title>
    <link rel="stylesheet" href="chatbot3.css" />
</head>
<body>
    <div class="black-bar">
        <a href="index.html" class="bar-link">HOME</a>
        <a href="chatbot1.html" class="bar-link">SOCRATES</a>
        <a href="chatbot2.html" class="bar-link">WILLIAM SHAKESPEARE</a>
        <a href="chatbot3.html" class="bar-link">MAYA ANGELOU</a>
        <a href="chatbot4.html" class="bar-link">MARCUS AURELIUS</a>
    </div>
    <div class="container">
        <h2>YOUR THERAPIST IS IN: MAYA ANGELOU</h2>
        <div class="paragraph">
            <p>Maya Angelou (1928-2014) was an American poet, memoirist, and civil rights activist. 
                Born Marguerite Annie Johnson in St. Louis, Missouri, she faced racial discrimination and trauma during her early years, experiences that would shape much of her later work. 
                Angelou's literary career flourished with her acclaimed autobiography "I Know Why the Caged Bird Sings," which detailed her childhood struggles. 
                She went on to write numerous volumes of poetry, essays, and autobiographies, earning widespread acclaim and accolades, including the Presidential Medal of Freedom. 
                Angelou's writing celebrated resilience, hope, and the power of the human spirit, making her a beloved and influential figure in American literature.</p>
        </div>
        <div class="panel chatbot">
            <div id="chat" class="chatbox">
                <div id="messages"></div>
                <div class="input-area">
                    <textarea id="user-message" placeholder="Type your message here..." onkeydown="handleKeyDown(event)"></textarea>
                    <button onclick="sendMessage()">Send a Message</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Define initial message from chatbot
        var initialMessage = "How can I help?";
        var messages = document.getElementById("messages");

        // Display initial message from chatbot
        var initialMessageDiv = document.createElement("div");
        initialMessageDiv.textContent = "Angelou: " + initialMessage;
        messages.appendChild(initialMessageDiv);

        // Load responses from movie_lines.txt
        var responses = {};

        // Function to load responses from text file
        function loadResponses() {
            fetch('movie_lines.txt')
                .then(response => response.text())
                .then(data => {
                    var lines = data.split('\n');
                    for (var i = 0; i < lines.length; i++) {
                        var parts = lines[i].split(' +++$+++ ');
                        if (parts.length === 5) {
                            responses[parts[0].trim()] = parts[4].trim();
                        }
                    }
                });
        }

        loadResponses();

        // Function to send message
        function sendMessage() {
            var userMessage = document.getElementById("user-message").value;

            // Function to send message
            let d = "chatbot response";

            let sendMessages = async () => {
                await fetch(`http://127.0.0.1:5000/front?message=${userMessage}&philo=3`, {
                    method: "POST",
                    body: JSON.stringify({
                        message: userMessage
                    }),
                    headers: {
                        "Content-type": "application/json; charset=UTF-8"
                    }
                });
            }

            let getResponse = async () => {
                await fetch(`http://127.0.0.1:5000/message/${userMessage}/`)
                    .then(response => response.json())
                    .then(data => {
                        d = data
                    })
            }
            sendMessages()
            setTimeout(function () {
                getResponse()

                setTimeout(function () {
                    var userMessageDiv = document.createElement("div");
                    userMessageDiv.className = "message-container user-message right";

                    var userIcon = document.createElement("img");
                    userIcon.src = "user.jpg"; 
                    userIcon.alt = "User Icon";
                    userIcon.className = "user-icon"; 
                    userMessageDiv.appendChild(userIcon);

                    var messageText = document.createElement("span");
                    messageText.textContent = "User: " + userMessage;
                    userMessageDiv.appendChild(messageText);

                    messages.appendChild(userMessageDiv);

                    var chatbotResponse = d;

                    var replyMessageDiv = document.createElement("div");
                    var angelouIcon = document.createElement("img");
                    angelouIcon.src = "Angelou.jpg"; 
                    angelouIcon.alt = "Angelou Icon";
                    angelouIcon.className = "philosopher-icon"; 
                    replyMessageDiv.appendChild(angelouIcon);

                    var responseText = document.createTextNode("Maya Angelou: " + chatbotResponse);
                    replyMessageDiv.appendChild(responseText);
                    replyMessageDiv.className = "message-container chatbot-message left";
                    messages.appendChild(replyMessageDiv);

                    document.getElementById("user-message").value = "";
                    messages.scrollTop = messages.scrollHeight; 
                }, 10000);
            }, 10000);
        }

        // Function to handle key down event in textarea
        function handleKeyDown(event) {
            if (event.key === "Enter") {
                event.preventDefault(); 
                sendMessage(); 
            }
        }
    </script>
</body>
</html>
